{"version":3,"file":"index.js","sources":["../../src/Viewers/index.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Tooltip } from 'core/src/Tooltip';\nimport { cssDecorator } from '@front-toolkit/utils';\nimport { Text } from 'core/src/typography';\n\nimport { IconEye } from 'core/src/icons';\n\nimport { ViewersProps } from './types';\n\nimport styles from './styles.scss';\n\nconst cd = cssDecorator(styles);\nconst Viewers: React.FC<ViewersProps> = ({\n  maxWidth,\n  size = 'default',\n  type = 'default',\n  items = [],\n  dataTestId,\n  tooltipDataTestId\n}) => {\n  const [numberShowItems, setNumberShowItems] = useState<number>();\n  const [tooltipText, setTooltipText] = useState('');\n\n  const refViewersList = useRef<HTMLDivElement>(null);\n\n  const showCounter = numberShowItems !== undefined;\n\n  const showItem = (index: number): boolean => Boolean(!showCounter || index < numberShowItems);\n\n  const isLastShowItem = (index: number): boolean => (showCounter\n    ? index === numberShowItems - 1\n    : index === items.length - 1);\n\n  useEffect(() => {\n    setNumberShowItems(undefined);\n    setTooltipText('');\n  }, [items, maxWidth, size]);\n\n  useEffect(() => {\n    if (refViewersList.current && !showCounter) {\n      const { clientWidth, children, scrollWidth } = refViewersList.current;\n\n      if (scrollWidth > clientWidth) {\n        let numberItems = 0;\n        let sumChildrenWidth = 0;\n        let newTooltipText = '';\n\n        Array.from(children).forEach((child, childIndex) => {\n          sumChildrenWidth += child.clientWidth;\n\n          if (sumChildrenWidth <= clientWidth) {\n            numberItems += 1;\n          } else {\n            const separator = childIndex !== items.length - 1 ? '\\n' : '';\n            newTooltipText += `${ items[childIndex] }${ separator }`;\n          }\n        });\n\n        setNumberShowItems(numberItems);\n        setTooltipText(newTooltipText);\n      }\n    }\n  }, [showCounter, items, maxWidth, size]);\n\n  if (!items.length) return null;\n\n  return (\n    <div\n      className={ cd('viewers_wrapper', { [type]: type }) }\n      data-test-id={ dataTestId }\n    >\n      <div className={ styles.viewers_block } style={ { maxWidth } }>\n        <div className={ styles.viewers_icon }>\n          <IconEye />\n        </div>\n        <div className={ styles.viewers_list } ref={ refViewersList }>\n          { items.map((item, itemIndex) => (\n            showItem(itemIndex) && (\n              <Text key={ item } color=\"inherit\" size={ size } inline>\n                { isLastShowItem(itemIndex) ? item : `${ item },\\u00A0` }\n              </Text>\n            )\n          )) }\n        </div>\n      </div>\n      { showCounter\n        && (\n          <Tooltip\n            placement=\"top\"\n            text={ tooltipText }\n            size=\"small\"\n            tailAlign=\"end\"\n            dataTestId={ tooltipDataTestId }\n          >\n            <div className={ cd('counter', { [type]: type, [size]: size }) }>\n              <Text color=\"inherit\" size={ size } inline>\n                { `+${ items.length - numberShowItems }` }\n              </Text>\n            </div>\n          </Tooltip>\n        ) }\n    </div>\n  );\n};\n\nexport { Viewers };\n"],"names":["cd","cssDecorator","styles","Viewers","_a","maxWidth","_d","size","_e","type","_f","items","dataTestId","tooltipDataTestId","_g","useState","numberShowItems","setNumberShowItems","_h","tooltipText","setTooltipText","refViewersList","useRef","showCounter","undefined","useEffect","current","clientWidth_1","children","numberItems_1","sumChildrenWidth_1","newTooltipText_1","Array","from","forEach","child","childIndex","clientWidth","separator","length","React","className","_b","viewers_block","style","viewers_icon","IconEye","viewers_list","ref","map","item","itemIndex","index","Boolean","Text","key","color","inline","isLastShowItem","Tooltip","placement","text","tailAlign","_c"],"mappings":"iZAWA,IAAMA,EAAKC,EAAaC,GAClBC,EAAkC,SAACC,WACvCC,aACAC,SAAAC,aAAO,YACPC,SAAAC,aAAO,YACPC,UAAAC,aAAQ,KACRC,eACAC,sBAEMC,EAAwCC,IAAvCC,OAAiBC,OAClBC,EAAgCH,EAAS,IAAxCI,OAAaC,OAEdC,EAAiBC,EAAuB,MAExCC,OAAkCC,IAApBR,EAuCpB,OA/BAS,GAAU,WACRR,OAAmBO,GACnBJ,EAAe,MACd,CAACT,EAAON,EAAUE,IAErBkB,GAAU,WACR,GAAIJ,EAAeK,UAAYH,EAAa,CACpC,IAAAnB,EAAyCiB,EAAeK,QAAtDC,gBAAaC,aAErB,iBAAkBD,EAAa,CAC7B,IAAIE,EAAc,EACdC,EAAmB,EACnBC,EAAiB,GAErBC,MAAMC,KAAKL,GAAUM,SAAQ,SAACC,EAAOC,GAGnC,IAFAN,GAAoBK,EAAME,cAEFV,EACtBE,GAAe,MACV,CACL,IAAMS,EAAYF,IAAezB,EAAM4B,OAAS,EAAI,KAAO,GAC3DR,GAAkB,GAAIpB,EAAMyB,GAAgBE,MAIhDrB,EAAmBY,GACnBT,EAAeW,OAGlB,CAACR,EAAaZ,EAAON,EAAUE,IAE7BI,EAAM4B,OAGTC,uBACEC,UAAYzC,EAAG,wBAAqB0C,EAACjC,GAAOA,qBAC7BG,GAEf4B,uBAAKC,UAAYvC,EAAOyC,cAAgBC,MAAQ,CAAEvC,aAChDmC,uBAAKC,UAAYvC,EAAO2C,cACtBL,gBAACM,SAEHN,uBAAKC,UAAYvC,EAAO6C,aAAeC,IAAM3B,GACzCV,EAAMsC,KAAI,SAACC,EAAMC,GAAc,OAjDvBC,EAkDCD,EAlD0BE,SAAS9B,GAAe6B,EAAQpC,IAmDjEwB,gBAACc,GAAKC,IAAML,EAAOM,MAAM,UAAUjD,KAAOA,EAAOkD,WAjDtC,SAACL,GAA2B,OAAC7B,EAChD6B,IAAUpC,EAAkB,EAC5BoC,IAAUzC,EAAM4B,OAAS,EAgDbmB,CAAeP,GAAaD,EAAWA,QApDtC,IAACE,OA0DZ7B,GAEEiB,gBAACmB,GACCC,UAAU,MACVC,KAAO1C,EACPZ,KAAK,QACLuD,UAAU,MACVlD,WAAaC,GAEb2B,uBAAKC,UAAYzC,EAAG,gBAAa+D,EAACtD,GAAOA,EAAMsD,EAACxD,GAAOA,OACrDiC,gBAACc,GAAKE,MAAM,UAAUjD,KAAOA,EAAOkD,WAChC,KAAK9C,EAAM4B,OAASvB,OAhCV,IAuC5B"}