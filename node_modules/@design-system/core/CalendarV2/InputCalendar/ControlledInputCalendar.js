import"focus-visible";import e,{useState as o,useMemo as n,useRef as a,useCallback as l,useEffect as r}from"react";import{IconCalendar as i}from"../../icons/index.js";import{ForwardedMaskInput as t}from"../../MaskedInput/index.js";import{PageCalendar as s}from"../../packages/core/shared/PageCalendar/index.js";import{CalendarPage as d}from"../../packages/core/shared/PageCalendar/types.js";import{getLocaleOptions as u}from"../../packages/core/shared/PageCalendar/utils.js";import{getCalendarState as c,getSelectedDateFromString as m,formatDateToString as f,validateDateInput as p,checkCurrentInputValid as h,stopPropagation as v}from"./utils.js";import{useBodyScrollLock as g}from"../hooks/useBodyScrollLock.js";import{useInputStyles as k}from"../hooks/useInputStyles.js";import b from"./InputCalendar.module.scss.js";var C=[{icon:e.createElement(i,null),disabled:!1,onClick:function(){}}];function y(i){var y=i.size,D=i.hintMessage,j=i.label,w=i.labelWidth,x=i.id,E=i.name,M=i.pseudo,P=i.disabled,W=i.showHint,I=i.labelAside,A=i.placeholder,z=i.onClick,B=i.onKeyPress,N=i.uncontrolled,R=i.onFocus,S=i.onBlur,F=i.onChange,H=i.maxDate,K=i.minDate,O=i.value,L=i.isError,T=i.withoutDefaultMinWidth,V=i.defaultValue,q=i.defaultPage,G=i.locale,J=i.hideWeekends,Q=i.fieldName,U=o(c(O,V,q)),X=U[0],Y=U[1],Z=o(!1),$=Z[0],_=Z[1],ee=n((function(){return m(O)}),[O]),oe=a(null),ne=k({labelAside:I,size:y,inputRef:oe}),ae=ne.positionStyles,le=ne.focusOnInput,re=a(null);g({targetRef:re});var ie=n((function(){return u(G,[5,6])}),[G]),te=l((function(e){Y({date:e.from,page:d.Days}),F&&F(f(e.from),Q)}),[F,Q]),se=l((function(e){F&&F(e,Q)}),[F,Q]),de=l((function(e){var o,n=!O||p(O,K,H);if(_(!n),!(null===(o=re.current)||void 0===o?void 0:o.contains(e.relatedTarget))){var a=(null==ee?void 0:ee.from)?d.Days:q;Y(c(null==ee?void 0:ee.from,void 0,a))}S&&S(e)}),[O,K,H,null==ee?void 0:ee.from,S,q]),ue=l((function(e){if(!P){var o=new Date,n=q;(null==ee?void 0:ee.from)&&(o=ee.from,n=d.Days),Y(c(o,V,n)),z&&z(e)}}),[P,q,null==ee?void 0:ee.from,V,z]);return r((function(){var e=!1;if(O){e=p(O,K,H);var o=h(O,e);_(!o)}else _(!1)}),[H,K,O]),e.createElement("div",{className:b.wrapper,role:"presentation",ref:re},e.createElement(t,{placeholderMask:"дд.мм.гггг",name:E,value:O,onChange:se,placeholder:A,isError:L||$,icons:C,size:y,hintMessage:D,label:j,labelWidth:w,id:x,pseudo:M,disabled:P,showHint:W,labelAside:I,inputRef:oe,onClick:ue,onKeyPress:B,uncontrolled:N,onFocus:R,onBlur:de,withoutDefaultMinWidth:T}),e.createElement("div",{className:b.dropdown,role:"presentation","aria-label":"Calendar",style:ae,onClick:v,tabIndex:-1},e.createElement(s,{maxDate:H,minDate:K,value:ee,openAt:X,localeOptions:ie,hideWeekends:J,onChange:te,onClick:le})))}export{y as ControlledInputCalendar};
//# sourceMappingURL=ControlledInputCalendar.js.map
