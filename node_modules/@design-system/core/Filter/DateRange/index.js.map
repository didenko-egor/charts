{"version":3,"file":"index.js","sources":["../../../src/Filter/DateRange/index.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\n\nimport { getTimePrefix } from 'core/utils/getTimePrefix';\n\nimport { DateItemRange, FilterDateRangeItem, FilterDateRangeProps } from '../types';\nimport FilterWrapper from '../FilterWrapper';\nimport InputDateTimeItems from './InputDateTimeItems';\n\nimport styles from './styles.scss';\n\nfunction format(value: Date | number | string): string {\n  const d = new Date(value);\n\n  const day = getTimePrefix(d.getDate());\n  const month = getTimePrefix(d.getMonth() + 1);\n  const year = d.getFullYear();\n  const hours = getTimePrefix(d.getHours());\n  const minutes = getTimePrefix(d.getMinutes());\n\n  return `${ day }.${ month }.${ year } ${ hours }:${ minutes }`;\n}\n\nfunction DateRange(props: FilterDateRangeProps): JSX.Element {\n  const {\n    config: {\n      title,\n      items,\n      options\n    },\n    activeItems,\n    isOpen: isControlledOpen,\n    isHiddenHeader,\n    zIndex,\n    onChange,\n    onOpenStatusChange\n  } = props;\n\n  const handleChangeSelected = useCallback((groupIndex: number, fieldIndex: keyof DateItemRange, value: Date): void => {\n    const newActiveItems: FilterDateRangeItem[] = JSON.parse(JSON.stringify(!activeItems.length ? items : activeItems));\n\n    const { range } = newActiveItems[groupIndex];\n\n    range[fieldIndex].value = value;\n\n    if (fieldIndex === 'start' && !range?.end?.value) {\n      newActiveItems[groupIndex].label = `${ format(value) } → До конца`;\n    }\n\n    if (fieldIndex === 'end' && !range?.start?.value) {\n      newActiveItems[groupIndex].label = `От начала → ${ format(value) }`;\n    }\n\n    if (range?.start?.value && range?.end?.value) {\n      const startValue = new Date(range.start.value);\n      const endValue = new Date(range.end.value);\n      newActiveItems[groupIndex].label = `${ format(startValue) } → ${ format(endValue) }`;\n    }\n\n    onChange(newActiveItems);\n  }, [activeItems, items, onChange]);\n\n  const handleOpenStatusChange = useCallback((value: boolean) => {\n    if (onOpenStatusChange) {\n      onOpenStatusChange(value);\n    }\n  }, [onOpenStatusChange]);\n\n  const handleClearAll = useCallback(\n    () => {\n      if (onChange) {\n        onChange([]);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <FilterWrapper\n      title={ title }\n      activeCount={ activeItems.length }\n      isOpen={ isControlledOpen }\n      onOpenStatusChange={ handleOpenStatusChange }\n      onClearAll={ handleClearAll }\n      isHiddenHeader={ isHiddenHeader }\n      zIndex={ zIndex }\n    >\n      <div className={ styles.container }>\n        { items.map(\n          (item, idx) => (\n            <InputDateTimeItems\n              key={ `${ item.filterId }-${ item.value }` }\n              groupIndex={ idx }\n              range={ item.range }\n              onSelect={ handleChangeSelected }\n              activeItem={ activeItems[idx] }\n              calendarOptions={ options?.calendar }\n            />\n          )\n        ) }\n      </div>\n    </FilterWrapper>\n  );\n}\n\nexport default DateRange;\n"],"names":["format","value","d","Date","getTimePrefix","getDate","getMonth","getFullYear","getHours","getMinutes","DateRange","props","_a","title","items","options","activeItems","isControlledOpen","isHiddenHeader","zIndex","onChange","onOpenStatusChange","handleChangeSelected","useCallback","groupIndex","fieldIndex","newActiveItems","JSON","parse","stringify","length","range","end","label","start","startValue","endValue","handleOpenStatusChange","handleClearAll","React","FilterWrapper","activeCount","isOpen","onClearAll","className","styles","container","map","item","idx","InputDateTimeItems","key","filterId","onSelect","activeItem","calendarOptions","calendar"],"mappings":"kOAUA,SAASA,EAAOC,GACd,IAAMC,EAAI,IAAIC,KAAKF,GAQnB,OANYG,EAAcF,EAAEG,eACdD,EAAcF,EAAEI,WAAa,OAC9BJ,EAAEK,kBACDH,EAAcF,EAAEM,gBACdJ,EAAcF,EAAEO,aAGlC,CAEA,SAASC,EAAUC,GAEf,IAAAC,EAWED,SAVAE,UACAC,UACAC,YAEFC,EAMEL,cALMM,EAKNN,SAJFO,EAIEP,iBAHFQ,EAGER,SAFFS,EAEET,WADFU,EACEV,qBAEEW,EAAuBC,GAAY,SAACC,EAAoBC,EAAiCxB,eACvFyB,EAAwCC,KAAKC,MAAMD,KAAKE,UAAWb,EAAYc,OAAiBd,EAARF,IAEtFiB,EAAUL,EAAeF,SAYjC,GAVAO,EAAMN,GAAYxB,MAAQA,EAEP,UAAfwB,cAA2BM,eAAAA,EAAOC,0BAAK/B,SACzCyB,EAAeF,GAAYS,MAAYjC,EAAOC,kBAG7B,QAAfwB,cAAyBM,eAAAA,EAAOG,4BAAOjC,SACzCyB,EAAeF,GAAYS,MAAQ,eAAgBjC,EAAOC,eAGxD8B,eAAAA,EAAOG,4BAAOjC,mBAAS8B,eAAAA,EAAOC,0BAAK/B,OAAO,CAC5C,IAAMkC,EAAa,IAAIhC,KAAK4B,EAAMG,MAAMjC,OAClCmC,EAAW,IAAIjC,KAAK4B,EAAMC,IAAI/B,OACpCyB,EAAeF,GAAYS,MAAYjC,EAAOmC,SAAmBnC,EAAOoC,GAG1EhB,EAASM,KACR,CAACV,EAAaF,EAAOM,IAElBiB,EAAyBd,GAAY,SAACtB,GACtCoB,GACFA,EAAmBpB,KAEpB,CAACoB,IAEEiB,EAAiBf,GACrB,WACMH,GACFA,EAAS,MAGb,CAACA,IAGH,OACEmB,gBAACC,GACC3B,MAAQA,EACR4B,YAAczB,EAAYc,OAC1BY,OAASzB,EACTI,mBAAqBgB,EACrBM,WAAaL,EACbpB,eAAiBA,EACjBC,OAASA,GAEToB,uBAAKK,UAAYC,EAAOC,WACpBhC,EAAMiC,KACN,SAACC,EAAMC,GAAQ,OACbV,gBAACW,GACCC,IAAUH,EAAKI,aAAcJ,EAAK/C,MAClCuB,WAAayB,EACblB,MAAQiB,EAAKjB,MACbsB,SAAW/B,EACXgC,WAAatC,EAAYiC,GACzBM,gBAAkBxC,eAAAA,EAASyC,eAOzC"}