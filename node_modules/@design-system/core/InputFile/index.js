import"focus-visible";import e,{useState as t,useRef as a,useCallback as i,useMemo as r}from"react";import{cssDecorator as n,noOp as o}from"@front-toolkit/utils";import"../typography/Caption/index.js";import"../typography/Label/index.js";import{Text as l}from"../typography/Text/index.js";import"../typography/Title/index.js";import s from"./screens/Upload/index.js";import d from"./screens/Loading/index.js";import m from"./screens/Uploaded/index.js";import{checkFileAccept as f,checkViewerVisible as p}from"./utils.js";import c from"./styles.scss.js";var u=n(c),g=function(e){e.preventDefault(),e.stopPropagation()};function v(n){var c,v,x=n.size,T=void 0===x?"default":x,y=n.textButton,h=void 0===y?"":y,b=n.accept,j=void 0===b?"image/*":b,z=n.textTypes,E=void 0===z?"JPG, PNG":z,D=n.multiple,C=void 0!==D&&D,L=n.onChange,S=void 0===L?o:L,_=n.isLoading,k=void 0!==_&&_,N=n.isLoadingText,P=void 0===N?"Загрузка...":N,w=n.onCancelLoading,A=void 0===w?o:w,B=n.errorText,G=n.enablePreview,U=void 0!==G&&G,F=n.files,J=void 0===F?[]:F,O=n.disabled,q=void 0!==O&&O,H=t(!1),I=H[0],K=H[1],M=t(!1),Q=M[0],R=M[1],V=a(null),W=i((function(e){if(null!==e.target.files){var t=Array.from(e.target.files),a=!t[0]||f(j,t[0]);R(!a),S(t)}}),[j,S]),X=i((function(e){g(e),q||e.dataTransfer.items&&e.dataTransfer.items.length>0&&K(!0)}),[q]),Y=i((function(){return K(!1)}),[]),Z=g,$=i((function(e){if(g(e),!q&&e.dataTransfer.items&&e.dataTransfer.items.length>0){var t=f(j,e.dataTransfer.files[0]);if(K(!1),R(!t),t){var a=Array.from(e.dataTransfer.files),i=C?a:a.slice(0,1);S(i)}e.dataTransfer.clearData()}}),[q,j,C,S]),ee=i((function(){V.current&&(V.current.value="",V.current.click())}),[]),te=i((function(){S([]),R(!1)}),[S]),ae=r((function(){return J.length<=0||f(j,J[0])}),[J,j]),ie=Q||B||!ae,re=U&&!C&&!ie&&!I&&!k&&J.length>=1,ne=!I&&!k&&!re,oe=u("input_file",((c={})[T]=!0,c.error=ie,c.dragging=I,c.upload=ne,c.loading=k,c.uploaded=re,c.uploaded_hidden=re&&!p(J[0]),c.disabled=q,c)),le="small"===T?"small":"default",se="small"===T?"small":"default",de="small"===T?"default":"large";return e.createElement("div",{className:u("wrapper",{stretch:"stretch"===T})},e.createElement("div",{className:oe,onDragEnter:X,onDragOver:Z,onDrop:$,onDragLeave:Y,"data-test-id":"inputFile_container"},ne&&e.createElement(s,{textButton:h,buttonSize:le,textSize:se,mediaTypes:E,onClick:ee,disabled:q}),k&&e.createElement(d,{loaderSize:de,textSize:se,loadingText:P,fileName:null===(v=J[0])||void 0===v?void 0:v.name,buttonSize:le,onCancel:A}),re&&e.createElement(m,{file:J[0],onDelete:te,textSize:se,disabled:q}),e.createElement("input",{type:"file",accept:j,multiple:C,ref:V,onChange:W})),ie&&e.createElement(l,{color:"negative_dark",size:"extra_small"},B||"Ошибка"))}export{v as InputFile};
//# sourceMappingURL=index.js.map
