{"version":3,"file":"ClearAllButton.js","sources":["../../../src/TextEditor/EditorControls/ClearAllButton.tsx"],"sourcesContent":["import React, { useCallback, useContext } from 'react';\nimport { Editor } from '@tiptap/react';\n\nimport { IconClearTypography } from 'core/src/icons';\n\nimport Button from '../Button';\nimport Group from '../Group';\nimport { EditorContext } from '../EditorContext';\nimport { ControlButtonProps } from './types';\n\n/** У либы есть баг при сбросе форматирования для вложенных списков - она удаляет их не полностью.\n * Так что проходим рекурсивно, пока все не уберем. */\nconst resetAllFormattings = (editor: Editor | null): void => {\n  editor?.chain().selectAll().unsetAllMarks().clearNodes()\n    .run();\n\n  const editorHasListElements = editor?.getHTML().includes('</li>');\n\n  if (editorHasListElements) {\n    resetAllFormattings(editor);\n  }\n};\n\nconst ClearAllButton: React.FC<ControlButtonProps> = ({ hidden }) => {\n  const { editor, disabled } = useContext(EditorContext);\n\n  const clearFormatHandler = useCallback((): void => {\n    const currentSelection = window.getSelection();\n\n    if (!currentSelection?.toString()) {\n      resetAllFormattings(editor);\n    } else {\n      /** При сбросе форматирования через unsetAllMarks сбрасываются в том числе и ссылки, что для нас неприемлемо */\n      editor?.chain().focus()\n        .unsetBold()\n        .unsetItalic()\n        .unsetSubscript()\n        .unsetSuperscript()\n        .run();\n    }\n  }, [editor]);\n\n  return (\n    <Group hidden={ hidden }>\n      <Button\n        onClick={ clearFormatHandler }\n        disabled={ disabled }\n        dataTestId=\"clear\"\n      >\n        <IconClearTypography />\n      </Button>\n    </Group>\n  );\n};\n\nClearAllButton.displayName = 'ClearAllButton';\n\nexport default React.memo(ClearAllButton);\n"],"names":["resetAllFormattings","editor","chain","selectAll","unsetAllMarks","clearNodes","run","getHTML","includes","ClearAllButton","_a","hidden","_b","useContext","EditorContext","disabled","clearFormatHandler","useCallback","currentSelection","window","getSelection","toString","focus","unsetBold","unsetItalic","unsetSubscript","unsetSuperscript","React","Group","Button","onClick","dataTestId","IconClearTypography","displayName","memo"],"mappings":"yOAYA,IAAMA,EAAsB,SAACC,GAC3BA,SAAAA,EAAQC,QAAQC,YAAYC,gBAAgBC,aACzCC,OAE2BL,eAAAA,EAAQM,UAAUC,SAAS,WAGvDR,EAAoBC,EAExB,EAEMQ,EAA+C,SAACC,OAAEC,WAChDC,EAAuBC,EAAWC,GAAhCb,WAAQc,aAEVC,EAAqBC,GAAY,WACrC,IAAMC,EAAmBC,OAAOC,gBAE3BF,eAAAA,EAAkBG,YAIrBpB,SAAAA,EAAQC,QAAQoB,QACbC,YACAC,cACAC,iBACAC,mBACApB,MARHN,EAAoBC,KAUrB,CAACA,IAEJ,OACE0B,gBAACC,GAAMjB,OAASA,GACdgB,gBAACE,GACCC,QAAUd,EACVD,SAAWA,EACXgB,WAAW,SAEXJ,gBAACK,SAIT,EAEAvB,EAAewB,YAAc,iBAE7B,MAAeN,EAAMO,KAAKzB"}