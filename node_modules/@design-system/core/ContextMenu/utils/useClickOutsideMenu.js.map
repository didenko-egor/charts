{"version":3,"file":"useClickOutsideMenu.js","sources":["../../../src/ContextMenu/utils/useClickOutsideMenu.tsx"],"sourcesContent":["import { useEffect } from 'react';\n\n/** Название data-аттрибута для метки меню в jsx */\nexport const MENU_STAMP_ATTR = 'menu-stamp';\n\nconst MENU_STAMP_DATA_ATTR = `data-${ MENU_STAMP_ATTR }`;\n\n/**\n * Определение кликов вне контекстного меню\n * @description При текущей реализации контекстные меню второго уровня\n * не являются дочерними элементами меню первого уровня.\n * Из-за этого нажатие по ним считаются за нажатия вне контекстного меню.\n *\n * Данный метод использует то, что подменю устанавливается такой же data-аттрибут, что и у внешнего меню.\n */\nexport function useClickOutsideMenu(\n  menuStamp: string,\n  callback?: VoidFunction\n): void {\n  useEffect(() => {\n    const onClickOutside = (event: Event): void => {\n      if (!callback) return;\n\n      const targetNode = event.target as Node;\n\n      let isClickInside = false;\n\n      /** Найдём родителя элемента меню - само меню */\n      let targetMenuParent: HTMLElement | null = targetNode.parentElement;\n\n      while (targetMenuParent && !isClickInside) {\n        targetMenuParent = targetMenuParent.parentElement;\n\n        if (!targetMenuParent || targetMenuParent.tagName === 'BODY') { break; }\n\n        isClickInside = isClickInside || targetMenuParent.getAttribute(MENU_STAMP_DATA_ATTR) === menuStamp;\n      }\n\n      if (!isClickInside) {\n        callback();\n      }\n    };\n\n    window.addEventListener('pointerdown', onClickOutside);\n\n    return (): void => {\n      window.removeEventListener('pointerdown', onClickOutside);\n    };\n  }, [menuStamp, callback]);\n}\n"],"names":["MENU_STAMP_ATTR","useClickOutsideMenu","menuStamp","callback","useEffect","onClickOutside","event","isClickInside","targetMenuParent","target","parentElement","tagName","getAttribute","window","addEventListener","removeEventListener"],"mappings":"sCAGaA,EAAkB,sBAYfC,EACdC,EACAC,GAEAC,GAAU,WACR,IAAMC,EAAiB,SAACC,GACtB,GAAKH,EAAL,CASA,IAPA,IAEII,GAAgB,EAGhBC,EALeF,EAAMG,OAK6BC,cAE/CF,IAAqBD,IAC1BC,EAAmBA,EAAiBE,gBAEkB,SAA7BF,EAAiBG,SAE1CJ,EAAgBA,GAAiBC,EAAiBI,aA9B7B,qBA8BoEV,EAGtFK,GACHJ,MAMJ,OAFAU,OAAOC,iBAAiB,cAAeT,GAEhC,WACLQ,OAAOE,oBAAoB,cAAeV,MAE3C,CAACH,EAAWC,GACjB"}