import{__spreadArray as e}from"tslib";import t,{useRef as r,useState as n,useCallback as i,useMemo as o,useEffect as l}from"react";import{v4 as s}from"uuid";import a from"../utils/xorSelectItem/index.js";import u from"../utils/getUniqueSelectItems/index.js";import"../packages/core/shared/InputHint/index.js";import"../packages/core/shared/InputLabel/index.js";import{BaseSelect as c}from"../packages/core/shared/BaseSelect/index.js";import{BaseInput as d}from"../shared/BaseInput/index.js";import{useFormContext as m}from"../shared/Form/formContext.js";import{Mark as f}from"../Mark/index.js";import{FieldWrapper as p}from"../FieldWrapper/index.js";import v from"../shared/BaseInput/coreStyles.scss.js";import b from"../shared/BaseInput/WithIcons/coreStyles.scss.js";import{IconPlus as I}from"../icons/index.js";import h from"./styles.scss.js";var j={},x=function(x){var S=x.id,g=x.items,C=x.label,E=x.disabled,k=x.labelAside,y=x.labelWidth,L=x.fieldName,A=x.size,B=void 0===A?"default":A,W=x.dataTestId,w=void 0===W?"tag_select_id":W,z=x.defaultSelectedItems,_=void 0===z?[]:z,D=x.onSelectedItemsChange,T=m({labelWidth:y,labelAside:k,size:B}),F=T.LABEL_WIDTH,H=T.LABEL_ASIDE,N=T.SIZE,q=r(null),M=r(!1),O=n(!1),R=O[0],U=O[1],V=n(""),Z=V[0],G=V[1],J=n(!1),K=J[0],P=J[1],Q=n(!1),X=Q[0],Y=Q[1],$=n(u(g,_)),ee=$[0],te=$[1],re=n(_),ne=re[0],ie=re[1],oe=i((function(){return U(!0)}),[]),le=i((function(){U(!1),P(!1),Y(!1),G("")}),[]),se=i((function(e){var t=ee.find((function(t){return t.value===e}));ie((function(e){return a(e,t)})),le()}),[ee,le]),ae=i((function(e){var t=e.trim();U(!0),P(!0),G(e),Y(!!t&&!ee.find((function(e){return e.label===t})))}),[ee]),ue=i((function(){var t,r={label:Z.trim(),value:s()};ie((function(t){return e(e([],t,!0),[r],!1)})),te((function(t){return e(e([],t,!0),[r],!1)})),le(),null===(t=q.current)||void 0===t||t.focus()}),[Z,le]),ce=i((function(e){return function(){ie((function(t){return t.filter((function(t){return t.value!==e}))}))}}),[]),de=o((function(){return ee.filter((function(e){var t=Z.trim();return e.label.toLowerCase().slice(0,t.length)===t.toLowerCase()}))}),[Z,ee]),me=o((function(){return[{icon:t.createElement(I,null),onClick:ue}]}),[ue]),fe=o((function(){return ne.map((function(e){return e.value}))}),[ne]);return l((function(){M.current?D(ne.map((function(e){return e.label})),L):M.current=!0}),[ne,L,D]),t.createElement(p,{id:S,size:N,disabled:E,label:C,labelAside:H,dataTestId:w,labelWidth:F},t.createElement(c,{size:N,activeValue:fe,items:K?de:ee,isOpenDropdown:R,onItemClick:se,onCloseDropdown:le},t.createElement(d,{id:S,inputRef:q,disabled:E,onChange:ae,onClick:oe,placeholder:"",value:Z,icons:X?me:void 0,styles:v,iconsStyles:b,wrapperStyles:j}),t.createElement("div",{className:h.tags},ne.map((function(e){return t.createElement(f,{key:e.value,text:e.label,onClose:e.disabled?void 0:ce(e.value),disabled:E,size:N,dataTestId:"selected_tag"})})))))};export{x as TagSelect};
//# sourceMappingURL=index.js.map
