{"version":3,"file":"index.js","sources":["../../../../../../shared/BaseSelect/DropdownList/index.tsx"],"sourcesContent":["import React, { RefObject, useMemo } from 'react';\nimport classNames from 'classnames/bind';\nimport { v4 as uuidv4 } from 'uuid';\nimport { ScrollBox } from 'shared/ScrollBox';\nimport { BaseSelectItem, SelectSize, BaseSelectProps } from 'core/types/select';\nimport useLoadMoreData from 'core/hooks/useLoadMoreData';\n\nimport { DropDown } from './DropDown';\nimport { ListItem, ListPlaceholder } from './ListItem';\n\nimport styles from './styles.scss';\n\nconst cn = classNames.bind(styles);\n\nconst loadingMessage = 'Загрузка...';\nconst errorMessage = 'Не найдено';\nexport type DropdownListProps = {\n  /** Массив элементов выпадающего списка */\n  items: Array<BaseSelectItem>;\n\n  /** Флаг загрузки dropdown */\n  isLoading?: boolean;\n\n  /** Value активного элемента из выпадающего списка */\n  activeValue?: string | string[];\n\n  /** Флаг открытия или закрытия выпадающего меню */\n  isOpenDropdown?: boolean;\n\n  /** Колбэк смены класса и выбор item */\n  onItemClick: (value: string) => void;\n\n  /** Ref списка */\n  dropDownRef?: RefObject<HTMLUListElement>;\n\n  /** Размер элементов выпадающего списка */\n  size?: SelectSize;\n\n  /** Включение режима fixed (совмещено с идентификатором выпадающего списка в этом режиме) */\n  fixedModeID?: string;\n\n  /** Колбэк для подгрузки данных по подскроллу */\n  onLoadMoreData?: VoidFunction;\n} & Pick<BaseSelectProps, 'itemDataTestId'>;\n\nconst DropdownList: React.FC<DropdownListProps> = ({\n  children,\n  items,\n  activeValue,\n  isOpenDropdown,\n  onItemClick,\n  size,\n  isLoading,\n  fixedModeID,\n  itemDataTestId,\n  onLoadMoreData,\n  dropDownRef\n}) => {\n  const itemsData = useMemo(() => items.map(item => ({\n    ...item,\n    id: uuidv4(),\n    onClick: (): void => onItemClick(item.value)\n  })), [items, onItemClick]);\n\n  const refInView = useLoadMoreData(onLoadMoreData);\n\n  const dropdownClassNames = cn('dropdown', { 'dropdown--open': isOpenDropdown });\n\n  const message = isLoading ? loadingMessage : errorMessage;\n\n  const list = useMemo(() => (\n    <>\n      { itemsData.map((item, index, arr) => (\n        <ListItem\n          key={ item.id }\n          item={ item }\n          size={ size }\n          activeValue={ activeValue }\n          dataTestId={ itemDataTestId }\n          ref={ index === arr.length - 1 ? refInView : null }\n        />\n      )) }\n    </>\n  ), [\n    activeValue,\n    itemDataTestId,\n    itemsData,\n    refInView,\n    size\n  ]);\n\n  return (\n    <>\n      { children }\n      <DropDown fixedModeID={ fixedModeID } isOpen={ isOpenDropdown || false }>\n        <ScrollBox maxHeight={ size === 'default' ? 368 : 336 } overrideWrapperClassName={ dropdownClassNames }>\n          { isOpenDropdown && (\n          <ul className={ styles.dropdown__list } ref={ dropDownRef }>\n            { isLoading || !itemsData.length\n              ? <ListPlaceholder size={ size }>{ message }</ListPlaceholder>\n              : list }\n          </ul>\n          ) }\n        </ScrollBox>\n      </DropDown>\n    </>\n  );\n};\n\nexport { DropdownList };\n"],"names":["cn","classNames","bind","styles","DropdownList","_a","children","items","activeValue","isOpenDropdown","onItemClick","size","isLoading","fixedModeID","itemDataTestId","onLoadMoreData","dropDownRef","itemsData","useMemo","map","item","id","uuidv4","onClick","value","refInView","useLoadMoreData","dropdownClassNames","message","list","React","index","arr","ListItem","key","dataTestId","ref","length","DropDown","isOpen","ScrollBox","maxHeight","overrideWrapperClassName","className","dropdown__list","ListPlaceholder"],"mappings":"gYAYA,IAAMA,EAAKC,EAAWC,KAAKC,GAiCrBC,EAA4C,SAACC,OACjDC,aACAC,UACAC,gBACAC,mBACAC,gBACAC,SACAC,cACAC,gBACAC,mBACAC,mBACAC,gBAEMC,EAAYC,GAAQ,WAAM,OAAAX,EAAMY,KAAI,SAAAC,GAAQ,cAC7CA,IACHC,GAAIC,IACJC,QAAS,WAAY,OAAAb,EAAYU,EAAKI,eACnC,CAACjB,EAAOG,IAEPe,EAAYC,EAAgBX,GAE5BY,EAAqB3B,EAAG,WAAY,CAAE,iBAAkBS,IAExDmB,EAAUhB,EAtDK,cACF,aAuDbiB,EAAOX,GAAQ,WAAM,OACzBY,gCACIb,EAAUE,KAAI,SAACC,EAAMW,EAAOC,GAAQ,OACpCF,gBAACG,GACCC,IAAMd,EAAKC,GACXD,KAAOA,EACPT,KAAOA,EACPH,YAAcA,EACd2B,WAAarB,EACbsB,IAAML,IAAUC,EAAIK,OAAS,EAAIZ,EAAY,aAIlD,CACDjB,EACAM,EACAG,EACAQ,EACAd,IAGF,OACEmB,gCACIxB,EACFwB,gBAACQ,GAASzB,YAAcA,EAAc0B,OAAS9B,IAAkB,GAC/DqB,gBAACU,GAAUC,UAAqB,YAAT9B,EAAqB,IAAM,IAAM+B,yBAA2Bf,GAC/ElB,GACFqB,sBAAIa,UAAYxC,EAAOyC,eAAiBR,IAAMpB,GAC1CJ,IAAcK,EAAUoB,OACtBP,gBAACe,GAAgBlC,KAAOA,GAASiB,GACjCC,KAOhB"}