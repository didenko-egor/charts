{"version":3,"file":"index.js","sources":["../../../../../../shared/BaseCalendar/MonthsList/index.tsx"],"sourcesContent":["import React, {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react';\nimport debounce from 'lodash.debounce';\nimport {\n  NewMonthType,\n  MonthListProps\n} from 'shared/types/calendar';\n\nimport {\n  monthsOffset,\n  getMonthByScroll\n} from '../utils';\nimport Month from './Month';\nimport Year from './Year';\n\nimport styles from './styles.scss';\n\nconst MonthsList: React.FC<MonthListProps> = ({\n  active,\n  locale,\n  months,\n  onMonthClick,\n  rowHeight,\n  today\n}) => {\n  const PADDING_TOP = useMemo(() => rowHeight * 5, [rowHeight]);\n  const PADDING_BOTTOM = useMemo(() => rowHeight * 6, [rowHeight]);\n\n  const [initiator, setInitiator] = useState<string | undefined>(undefined);\n\n  const listRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    if (listRef) {\n      setInitiator('outside');\n      listRef?.current?.scroll({ top: monthsOffset(active, months[0], rowHeight) });\n    }\n  }, [active, months, rowHeight]);\n\n  const getList = useCallback((): ReactNode => {\n    const list: ReactNode[] = [];\n\n    months.forEach((item: NewMonthType, index: number): void => {\n      const { month, year } = item;\n      const date = new Date(year, month, 1);\n      const isToday = (today.getMonth() === month) && (today.getFullYear() === year);\n      const isActive = (active?.getMonth() === month) && (active?.getFullYear() === year);\n\n      if (month === 0 && index !== 0) {\n        list.push(\n          <Year\n            key={ `year-${ year }` }\n            date={ date }\n          />\n        );\n      }\n\n      list.push(<Month\n        key={ `${ month }-${ year }` }\n        date={ date }\n        isActive={ isActive }\n        isToday={ isToday }\n        locale={ locale }\n        onMonthClick={ onMonthClick }\n      />);\n    });\n\n    return list;\n  }, [\n    months,\n    today,\n    active,\n    locale,\n    onMonthClick\n  ]);\n\n  const updateValue = debounce(() => {\n    if (!initiator) {\n      onMonthClick(getMonthByScroll(listRef.current?.scrollTop, months[0], rowHeight));\n    }\n    setInitiator(undefined);\n  }, 300);\n\n  const handleScroll = useCallback((): void => {\n    updateValue();\n  }, [updateValue]);\n\n  useEffect(() => {\n    const { current } = listRef;\n\n    if (months.length > 0) {\n      current?.addEventListener('scroll', handleScroll);\n    }\n\n    return (): void => {\n      current?.removeEventListener('scroll', handleScroll);\n    };\n  }, [months, initiator, handleScroll]);\n\n  return (\n    <div className={ styles.monthlist } ref={ listRef }>\n      <div className={ styles.padding } style={ { height: PADDING_TOP } } />\n      { getList() }\n      <div className={ styles.padding } style={ { height: PADDING_BOTTOM } } />\n    </div>\n  );\n};\n\nexport default MonthsList;\n"],"names":["MonthsList","_a","active","locale","months","onMonthClick","rowHeight","today","PADDING_TOP","useMemo","PADDING_BOTTOM","_b","useState","undefined","initiator","setInitiator","listRef","useRef","useEffect","current","scroll","top","monthsOffset","getList","useCallback","list","forEach","item","index","month","year","date","Date","isToday","getMonth","getFullYear","isActive","push","React","Year","key","Month","updateValue","debounce","getMonthByScroll","scrollTop","handleScroll","length","addEventListener","removeEventListener","className","styles","monthlist","ref","padding","style","height"],"mappings":"sSAuBMA,EAAuC,SAACC,OAC5CC,WACAC,WACAC,WACAC,iBACAC,cACAC,UAEMC,EAAcC,GAAQ,WAAM,OAAY,EAAZH,IAAe,CAACA,IAC5CI,EAAiBD,GAAQ,WAAM,OAAY,EAAZH,IAAe,CAACA,IAE/CK,EAA4BC,OAA6BC,GAAxDC,OAAWC,OAEZC,EAAUC,EAA8B,MAE9CC,GAAU,iBACJF,IACFD,EAAa,qBACbC,eAAAA,EAASG,wBAASC,OAAO,CAAEC,IAAKC,EAAapB,EAAQE,EAAO,GAAIE,QAEjE,CAACJ,EAAQE,EAAQE,IAEpB,IAAMiB,EAAUC,GAAY,WAC1B,IAAMC,EAAoB,GA2B1B,OAzBArB,EAAOsB,SAAQ,SAACC,EAAoBC,GAC1B,IAAAC,EAAgBF,QAATG,EAASH,OAClBI,EAAO,IAAIC,KAAKF,EAAMD,EAAO,GAC7BI,EAAW1B,EAAM2B,aAAeL,GAAWtB,EAAM4B,gBAAkBL,EACnEM,GAAYlC,eAAAA,EAAQgC,cAAeL,IAAW3B,eAAAA,EAAQiC,iBAAkBL,EAEhE,IAAVD,GAAyB,IAAVD,GACjBH,EAAKY,KACHC,gBAACC,GACCC,IAAM,QAASV,EACfC,KAAOA,KAKbN,EAAKY,KAAKC,gBAACG,GACTD,IAAUX,MAAWC,EACrBC,KAAOA,EACPK,SAAWA,EACXH,QAAUA,EACV9B,OAASA,EACTE,aAAeA,QAIZoB,IACN,CACDrB,EACAG,EACAL,EACAC,EACAE,IAGIqC,EAAcC,GAAS,iBACtB7B,GACHT,EAAauC,YAAiB5B,EAAQG,8BAAS0B,UAAWzC,EAAO,GAAIE,IAEvES,OAAaF,KACZ,KAEGiC,EAAetB,GAAY,WAC/BkB,MACC,CAACA,IAcJ,OAZAxB,GAAU,WACA,IAAAC,EAAYH,UAMpB,OAJIZ,EAAO2C,OAAS,IAClB5B,SAAAA,EAAS6B,iBAAiB,SAAUF,IAG/B,WACL3B,SAAAA,EAAS8B,oBAAoB,SAAUH,MAExC,CAAC1C,EAAQU,EAAWgC,IAGrBR,uBAAKY,UAAYC,EAAOC,UAAYC,IAAMrC,GACxCsB,uBAAKY,UAAYC,EAAOG,QAAUC,MAAQ,CAAEC,OAAQhD,KAClDe,IACFe,uBAAKY,UAAYC,EAAOG,QAAUC,MAAQ,CAAEC,OAAQ9C,KAG1D"}