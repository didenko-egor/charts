{"version":3,"file":"index.js","sources":["../../../src/SelectDropDown/SelectList/index.tsx"],"sourcesContent":["// TODO написать тесты\nimport React, { useCallback, useMemo } from 'react';\n\nimport { OnClickItem } from '../sharedTypes';\nimport { SelectDropDownProps } from '../types';\nimport { RESET_ITEM_VALUE } from '../constants';\nimport Item, { ItemProps } from './Item';\n\nimport styles from './styles.scss';\n\ntype InheritedProps = Pick<ItemProps, 'useRightKeeper'>\n& Pick<SelectDropDownProps, 'items'\n| 'activeValues'\n| 'itemResetLabel'\n| 'isMultiselect'\n| 'onChange'\n| 'dataTestId'>;\n\nexport interface SelectListProps extends InheritedProps {\n  /** Метод, инициирующий закрытие выпадашки, в которую встраивается список */\n  onCloseDropDown?: SelectDropDownProps['onCloseDropDown'];\n\n  /** Флаг траурного режима */\n  isMourning?: boolean;\n}\n\n/* eslint-disable react/default-props-match-prop-types */\nexport const DEFAULT_PROPS = {\n  isMultiselect: false,\n  useRightKeeper: false\n};\n/* eslint-enable react/default-props-match-prop-types */\n\nconst SelectList: React.FC<SelectListProps> = props => {\n  const {\n    items,\n    activeValues,\n    itemResetLabel,\n    onChange,\n    onCloseDropDown,\n    isMultiselect = DEFAULT_PROPS.isMultiselect,\n    useRightKeeper = DEFAULT_PROPS.useRightKeeper,\n    dataTestId,\n    isMourning\n  } = props;\n  const activeMap = useMemo(() => new Set(activeValues), [activeValues]);\n\n  const onClickItem = useCallback<OnClickItem>(clickedValue => {\n    let newActiveValues: string[] = [];\n    const clickedIsActive = activeMap.has(clickedValue as string);\n\n    if (clickedValue === RESET_ITEM_VALUE) {\n      if (activeValues.length > 0) {\n        onChange(newActiveValues);\n      }\n\n      if (onCloseDropDown && !isMultiselect) { onCloseDropDown(); }\n\n      return;\n    }\n\n    if (isMultiselect) {\n      newActiveValues = clickedIsActive\n        ? activeValues.filter(value => value !== clickedValue)\n        : [...activeValues, clickedValue];\n    } else {\n      newActiveValues = clickedIsActive ? [] : [clickedValue];\n\n      if (onCloseDropDown) { onCloseDropDown(); }\n    }\n\n    onChange(newActiveValues);\n  }, [\n    activeMap,\n    isMultiselect,\n    onChange,\n    activeValues,\n    onCloseDropDown\n  ]);\n\n  return (\n    <div className={ styles.list } data-test-id={ dataTestId }>\n      { Boolean(itemResetLabel) && (\n        <Item\n          value={ RESET_ITEM_VALUE }\n          label={ itemResetLabel }\n          onClick={ onClickItem }\n          withIcon={ false }\n          isActive={ !activeValues.length }\n          useLeftKeeper={ isMultiselect }\n          useRightKeeper={ useRightKeeper }\n          isMourning={ isMourning }\n        />\n      ) }\n      {\n        items.map(({ label, value, disabled }) => (\n          <Item\n            key={ value }\n            value={ value }\n            label={ label }\n            disabled={ disabled }\n            onClick={ onClickItem }\n            isActive={ activeMap.has(value) }\n            withIcon={ isMultiselect }\n            useRightKeeper={ useRightKeeper }\n            isMourning={ isMourning }\n          />\n        ))\n      }\n    </div>\n  );\n};\n\nSelectList.defaultProps = DEFAULT_PROPS;\n\nexport default SelectList;\n"],"names":["DEFAULT_PROPS","isMultiselect","useRightKeeper","SelectList","props","items","activeValues","itemResetLabel","onChange","onCloseDropDown","_a","_b","dataTestId","isMourning","activeMap","useMemo","Set","onClickItem","useCallback","clickedValue","newActiveValues","clickedIsActive","has","RESET_ITEM_VALUE","length","filter","value","React","className","styles","list","Boolean","Item","label","onClick","withIcon","isActive","useLeftKeeper","map","disabled","key","defaultProps"],"mappings":"0MA2BaA,EAAgB,CAC3BC,eAAe,EACfC,gBAAgB,GAIZC,EAAwC,SAAAC,GAE1C,IAAAC,EASED,QARFE,EAQEF,eAPFG,EAOEH,iBANFI,EAMEJ,WALFK,EAKEL,kBAJFM,EAIEN,gBAJFH,aAAgBD,EAAcC,gBAC9BU,EAGEP,iBAHFF,aAAiBF,EAAcE,iBAC/BU,EAEER,aADFS,EACET,aACEU,EAAYC,GAAQ,WAAM,OAAA,IAAIC,IAAIV,KAAe,CAACA,IAElDW,EAAcC,GAAyB,SAAAC,GAC3C,IAAIC,EAA4B,GAC1BC,EAAkBP,EAAUQ,IAAIH,GAEtC,GAAIA,IAAiBI,EAOnB,OANIjB,EAAakB,OAAS,GACxBhB,EAASY,QAGPX,IAAoBR,GAAiBQ,KAKvCR,EACFmB,EAAkBC,EACdf,EAAamB,QAAO,SAAAC,GAAS,OAAAA,IAAUP,YACnCb,OAAca,QAEtBC,EAAkBC,EAAkB,GAAK,CAACF,GAEtCV,GAAmBA,KAGzBD,EAASY,KACR,CACDN,EACAb,EACAO,EACAF,EACAG,IAGF,OACEkB,uBAAKC,UAAYC,EAAOC,oBAAsBlB,GAC1CmB,QAAQxB,IACRoB,gBAACK,GACCN,MAAQH,EACRU,MAAQ1B,EACR2B,QAAUjB,EACVkB,UAAW,EACXC,UAAY9B,EAAakB,OACzBa,cAAgBpC,EAChBC,eAAiBA,EACjBW,WAAaA,IAIfR,EAAMiC,KAAI,SAAC5B,OAAEuB,UAAOP,UAAOa,aAAe,OACxCZ,gBAACK,GACCQ,IAAMd,EACNA,MAAQA,EACRO,MAAQA,EACRM,SAAWA,EACXL,QAAUjB,EACVmB,SAAWtB,EAAUQ,IAAII,GACzBS,SAAWlC,EACXC,eAAiBA,EACjBW,WAAaA,OAMzB,EAEAV,EAAWsC,aAAezC"}